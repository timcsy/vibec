(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=s(o);fetch(o.href,u)}})();const y={A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",I:"..",J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",Q:"--.-",R:".-.",S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",Y:"-.--",Z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----.",".":".-.-.-",",":"--..--","?":"..--..","'":".----.","!":"-.-.--","/":"-..-.","(":"-.--.-",")":"-.--.-","&":".-...",":":"---...",";":"-.-.-.","=":"-...-","+":".-.-.","-":"-....-",_:"..--.-",'"':".-..-.",$:"...-..-"},g={};Object.entries(y).forEach(([t,n])=>{g[n]=t});const B="·",M="—",T=500,v=1e3;function f(t){if(!t)return null;const n=t.replace(/·/g,".").replace(/—/g,"-").trim();return g[n]||null}function h(t){return t.replace(/\./g,B).replace(/-/g,M)}function q(){return{...y}}function c(t){const n=document.getElementById("morse-output");if(!t){n.innerHTML='<span class="empty-state">等待輸入...</span>';return}const s=h(t);n.textContent=s}function i(t){const n=document.getElementById("char-output");t?t==="?"?(n.innerHTML='<span style="color: #ff9800;">?</span>',n.title="無效的摩斯密碼序列"):(n.textContent=t,n.title=""):n.innerHTML='<span class="empty-state">-</span>'}function a(t){const n=document.getElementById("message-output");!t||t.trim()===""?n.innerHTML='<span class="empty-state">訊息將顯示在此</span>':n.textContent=t}function S(t,n=3e3){const s=document.getElementById("error-message");s.textContent=t,s.classList.add("show"),n>0&&setTimeout(()=>{s.classList.remove("show")},n)}function E(){document.getElementById("error-message").classList.remove("show")}function O(t){const n=document.getElementById("morse-table-body");if(!n)return;const s=Object.keys(t).filter(r=>/^[A-Z0-9]$/.test(r)).sort();n.innerHTML=s.map(r=>{const o=t[r],u=h(o);return`
      <tr>
        <td>${r}</td>
        <td>${u}</td>
      </tr>
    `}).join("")}function p(){return document.getElementById("main-button")}function D(){return document.getElementById("undo-button")}function b(){return document.getElementById("clear-button")}const e={currentSequence:"",outputMessage:"",history:[],isButtonPressed:!1,pressStartTime:0,lastReleaseTime:0};function C(){O(q()),w(),c(""),i(null),a("")}function w(){const t=p(),n=D(),s=b();t.addEventListener("pointerdown",m),t.addEventListener("pointerup",d),t.addEventListener("pointercancel",d),document.addEventListener("keydown",r=>{r.code==="Space"&&!e.isButtonPressed&&(r.preventDefault(),m())}),document.addEventListener("keyup",r=>{r.code==="Space"&&e.isButtonPressed&&(r.preventDefault(),d())}),n.addEventListener("click",R),s.addEventListener("click",A),t.addEventListener("contextmenu",r=>r.preventDefault())}function m(){e.isButtonPressed=!0,e.pressStartTime=Date.now();const t=p();t.classList.add("active"),t.setAttribute("aria-pressed","true"),t.textContent="保持按住...",E()}function d(){if(!e.isButtonPressed)return;e.isButtonPressed=!1;const t=p();t.classList.remove("active"),t.setAttribute("aria-pressed","false"),t.textContent="按住輸入摩斯密碼";const n=Date.now()-e.pressStartTime,s=Date.now();e.lastReleaseTime&&e.pressStartTime-e.lastReleaseTime>v&&e.currentSequence&&(L(),e.outputMessage+=" ",a(e.outputMessage)),e.lastReleaseTime=s,n<T?(e.currentSequence+=".",e.history.push(".")):(e.currentSequence+="-",e.history.push("-")),c(e.currentSequence);const r=f(e.currentSequence);r?i(r):e.currentSequence&&i("?")}function L(){if(!e.currentSequence)return;const t=f(e.currentSequence);t?e.outputMessage+=t:e.outputMessage+="?",e.history.push(" "),e.currentSequence="",c(""),i(null)}function P(){e.currentSequence&&(L(),a(e.outputMessage))}function R(){if(e.history.length===0){S("沒有可撤銷的操作",2e3);return}if(e.history.pop()===" "){let s="";for(let r=e.history.length-1;r>=0&&e.history[r]!==" ";r--)s=e.history[r]+s;e.currentSequence=s}else e.currentSequence=e.currentSequence.slice(0,-1);e.outputMessage.length>0&&(e.outputMessage=e.outputMessage.slice(0,-1)),c(e.currentSequence),a(e.outputMessage);const n=f(e.currentSequence);n?i(n):e.currentSequence?i("?"):i(null)}function A(){if(!e.outputMessage&&!e.currentSequence){S("已經是空的",1500);return}e.currentSequence="",e.outputMessage="",e.history=[],e.lastReleaseTime=0,c(""),i(null),a(""),E()}document.addEventListener("keydown",t=>{t.key==="Enter"&&e.currentSequence&&(t.preventDefault(),P())});C();
